<!DOCTYPE html>

<html>
<head>
  <title>utensils.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>utensils.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <pre><code>Utensils.js <span class="hljs-number">1.1</span><span class="hljs-number">.2</span>
</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <pre><code>(c) <span class="hljs-number">2014</span> Michael Phillips
Utensils may be freely distributed under the MIT license.
For all details and documentation:
http:<span class="hljs-comment">//utensilsjs.org</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>
(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(root, factory)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Set up Utensils appropriately for the environment. Start with AMD.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd) {
    define([<span class="hljs-string">'underscore'</span>, <span class="hljs-string">'q'</span>, <span class="hljs-string">'exports'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(_, Q, exports)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Export global even in AMD case in case this script is loaded with
others that may still expect a global Utensils.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      root.Utensils = factory(root, exports, _, Q);
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Next for Node.js or CommonJS.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> exports !== <span class="hljs-string">'undefined'</span>) {
    <span class="hljs-keyword">var</span> _ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'underscore'</span>);
    <span class="hljs-keyword">var</span> Q = <span class="hljs-built_in">require</span>(<span class="hljs-string">'q'</span>);
    factory(root, exports, _);</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Finally, as a browser global.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  } <span class="hljs-keyword">else</span> {
    root.Utensils = factory(root, {}, root._, root.Q);
  }

}(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(root, Utensils, _, Q)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h2 id="initial-setup">Initial Setup</h2>

            </div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Save the previous value of the <code>Utensils</code> variable, so that it can be
restored later on, if <code>noConflict</code> is used.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> previousUtensils = root.Utensils;</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Current version of the library. Keep in sync with <code>package.json</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Utensils.VERSION = <span class="hljs-string">'0.1.0'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Runs Utensils.js in <em>noConflict</em> mode, returning the <code>Utensils</code> variable
to its previous owner. Returns a reference to this Utensils object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Utensils.noConflict = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    root.Utensils = previousUtensils;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  };

  <span class="hljs-keyword">var</span> Base = Utensils.Base = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">var</span> args = _.toArray( <span class="hljs-built_in">arguments</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>cast .argumentName String to .argumentNames Array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> argumentName = _.result( <span class="hljs-keyword">this</span>, <span class="hljs-string">'argumentName'</span> );
    <span class="hljs-keyword">if</span> ( _.isString( argumentName ) &amp;&amp; _.isUndefined( <span class="hljs-keyword">this</span>.argumentNames )) 
      <span class="hljs-keyword">this</span>.argumentNames = [ argumentName ];</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>store the original arguments Array on the instance
and prevent make it immutable to preserve raw input</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.arguments = _.object( <span class="hljs-keyword">this</span>.argumentNames, args );
    <span class="hljs-built_in">Object</span>.freeze( <span class="hljs-keyword">this</span>.arguments );</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>attach arguments to the instance 
with defined names if names are defined</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.argumentNames ) {
      _.each( args, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, index)</span> </span>{
        self[self.argumentNames[index]] = value;
      });
    }
  };

  Base.extend = extend;</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <h2 id="value">Value</h2>

            </div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
  <span class="hljs-keyword">var</span> Value = Utensils.Value = Base.extend({

    argumentName: <span class="hljs-string">'value'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>special method in JavaScript, is used for 
all comparators except equality, by default 
returns the same value as was passed
into the constructor</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    valueOf: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[ <span class="hljs-keyword">this</span>.argumentName ];
    }

  });</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Functional equality utility method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Value.isEqualTo = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( a, b )</span> </span>{
    <span class="hljs-keyword">return</span> a.valueOf() === b.valueOf();
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Functional inequality utility method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Value.isNotEqualTo = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( a, b )</span> </span>{
    <span class="hljs-keyword">return</span> a.valueOf() !== b.valueOf();
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>List of methods that are applied directly to the constructor
as static methods to offer a functional style, but 
should be offered as partially applied versions
on the prototype.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> methodsToScopeToPrototype = [ <span class="hljs-string">'isEqualTo'</span>, <span class="hljs-string">'isNotEqualTo'</span> ];</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Scope the methods to the prototype,
pre-filling the first method with the instance</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _.each( methodsToScopeToPrototype, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( fnName )</span> </span>{
    Value.prototype[fnName] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">return</span> _.partial( Value[ fnName ], <span class="hljs-keyword">this</span> ).apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
    };
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <h2 id="service">Service</h2>

            </div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
  <span class="hljs-keyword">var</span> Service = Utensils.Service = Base.extend({

    constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      Base.prototype.constructor.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>if only one method is defined on the prototype
use that for the procedure, meaning this.procedure
doesn’t need to be described with just one value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> protoPropProcedureMethods = _.functions( <span class="hljs-keyword">this</span>.constructor.__protoProps__ );
      <span class="hljs-keyword">if</span> ( protoPropProcedureMethods.length === <span class="hljs-number">1</span> ) {
        <span class="hljs-keyword">this</span>.procedure = protoPropProcedureMethods;
      }

      <span class="hljs-keyword">this</span>.procedureMethods = prepareProcedureMethods( <span class="hljs-keyword">this</span>.procedure );
    },

    run: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

      <span class="hljs-keyword">return</span> promiseSequence( <span class="hljs-keyword">this</span>.procedureMethods )
        .then(<span class="hljs-keyword">this</span>.success)
        .fail(<span class="hljs-keyword">this</span>.error);
    }

  });</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <h2 id="form">Form</h2>

            </div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>  
  <span class="hljs-keyword">var</span> Form = Utensils.Form = Base.extend({

    argumentName: <span class="hljs-string">'data'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>map #run for expressive API</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    process: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.run.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>default procedure for a form object 
is to first validate the input and then
process the form</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    procedure: [
      <span class="hljs-string">'validate'</span>,
      <span class="hljs-string">'process'</span>
    ],

    run: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>if a constructor is defined on .validator, 
overwrite #validate with a promise-wrapped 
function returning a new instance of the constructor</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.validator ) {
        <span class="hljs-keyword">this</span>.validate = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> self.validator( self[ self.argumentNames[<span class="hljs-number">0</span>] ] ).run(); }
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>if a constructor is defined on .processor, 
overwrite #process with a promise-wrapped 
function returning a new instance of the constructor</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.processor ) {
        <span class="hljs-keyword">this</span>.process = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> self.processor( self.argumentNames[<span class="hljs-number">0</span>] ).run(); }
      }
      
      <span class="hljs-keyword">var</span> procedureMethods = prepareProcedureMethods( <span class="hljs-keyword">this</span>.procedure );

      <span class="hljs-keyword">return</span> promiseSequence( procedureMethods )
        .then(<span class="hljs-keyword">this</span>.success)
        .fail(<span class="hljs-keyword">this</span>.error);
    }

  });</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <h2 id="query">Query</h2>

            </div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>  
  <span class="hljs-keyword">var</span> Query = Base.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>map #run for expressive API</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    perform: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.run.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
    },

    run: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

      <span class="hljs-keyword">var</span> procedureMethods = prepareProcedureMethods( <span class="hljs-keyword">this</span>.procedure );

      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.setup()
        .then(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
          <span class="hljs-keyword">return</span> utilities.promiseSequence( procedureMethods )
            .then(self.success)
            .fail(self.error);
        });
    },

    setup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.db()
        .then(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( db )</span> </span>{
          <span class="hljs-keyword">return</span> db;
        })
        .then(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( db )</span> </span>{
          <span class="hljs-keyword">return</span> self.buildCollections( db );
        });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>attach all collections to the object
context with the name of the collection
and “Collection”, so for the “accounts” collection,
the collection would be scoped to the 
context as “accountsCollection”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    buildCollections: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( db )</span> </span>{
      <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>var foo = ‘accounts’;<br>Q.ninvoke( db, ‘collection’, foo )
  .then(function( collection ) { console.log( collection ); });</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.collections = {};
      <span class="hljs-keyword">var</span> collectionPromises = _.map( <span class="hljs-keyword">this</span>.collectionNames, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( collectionName )</span> </span>{
        <span class="hljs-keyword">return</span> Q.ninvoke( db, <span class="hljs-string">'collection'</span>, collectionName )
          .then(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( collection )</span> </span>{
            self.collections[ collectionName ] = collection;
          });
      });

      <span class="hljs-keyword">return</span> Q.all( collectionPromises );
    }

  });</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <h2 id="helpers">Helpers</h2>

            </div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">extend</span><span class="hljs-params">(protoProps, staticProps)</span> </span>{
    <span class="hljs-keyword">var</span> parent = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">var</span> child;

    <span class="hljs-keyword">if</span> (protoProps &amp;&amp; _.has(protoProps, <span class="hljs-string">'constructor'</span>)) {
      child = protoProps.constructor;
    } <span class="hljs-keyword">else</span> {
      child = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{ <span class="hljs-keyword">return</span> parent.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>); };
    }

    _.extend(child, parent, staticProps);

    <span class="hljs-keyword">var</span> Surrogate = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{ <span class="hljs-keyword">this</span>.constructor = child; };
    Surrogate.prototype = parent.prototype;
    child.prototype = <span class="hljs-keyword">new</span> Surrogate;

    <span class="hljs-keyword">if</span> (protoProps) _.extend(child.prototype, protoProps);

    child.__super__ = parent.prototype;
    child.__protoProps__ = protoProps;

    <span class="hljs-keyword">return</span> child;
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Attach #extend to each of the base objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _.each([ Value, <span class="hljs-comment">/*Service, Form, Validator, Query, Presenter, Policy, Decorator*/</span> ], <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( Ctor )</span> </span>{
    Ctor.extend = extend;
  });

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">prepareProcedureMethods</span><span class="hljs-params">( procedureMethodKeys, options )</span> </span>{
    options = ( options || {} );
    
    <span class="hljs-keyword">var</span> procedureMethods;

    procedureMethods = utilities.getObjectMethodsByName( procedureMethodKeys, <span class="hljs-keyword">this</span>, options );
    procedureMethods = utilities.wrapAnySequenceFunctionsThatRequestedPromises( procedureMethods, options.context || <span class="hljs-keyword">this</span>, options );
    procedureMethods = utilities.returnBoundObjectMethods( procedureMethods, options.context || <span class="hljs-keyword">this</span>, options );

    <span class="hljs-keyword">return</span> procedureMethods;
  };

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">promiseSequence</span><span class="hljs-params">(fns, initialVal)</span> </span>{
    <span class="hljs-keyword">return</span> fns.reduce(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(soFar, f)</span> </span>{
      <span class="hljs-keyword">return</span> soFar.then(f);
    }, initialVal ? Q(initialVal) : Q.when());
  };

  <span class="hljs-keyword">return</span> Utensils;

}));</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
